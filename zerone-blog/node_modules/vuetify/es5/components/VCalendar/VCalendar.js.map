{"version":3,"sources":["../../../src/components/VCalendar/VCalendar.ts"],"names":[],"mappings":"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","sourcesContent":["// Styles\n// import '../../stylus/components/_calendar-daily.styl'\n\n// Types\nimport { VNode, Component } from 'vue'\n\n// Mixins\nimport CalendarWithEvents from './mixins/calendar-with-events'\n\n// Util\nimport props from './util/props'\nimport {\n  DAYS_IN_MONTH_MAX,\n  DAY_MIN,\n  DAYS_IN_WEEK,\n  VTimestamp,\n  VTime,\n  parseTimestamp,\n  validateTimestamp,\n  relativeDays,\n  nextDay,\n  prevDay,\n  copyTimestamp,\n  updateFormatted,\n  updateWeekday,\n  updateRelative,\n  getStartOfMonth,\n  getEndOfMonth,\n} from './util/timestamp'\n\n// Calendars\nimport VCalendarMonthly from './VCalendarMonthly'\nimport VCalendarDaily from './VCalendarDaily'\nimport VCalendarWeekly from './VCalendarWeekly'\n\n// Types\ninterface VCalendarRenderProps {\n  start: VTimestamp\n  end: VTimestamp\n  component: string | Component\n  maxDays: number\n}\n\n/* @vue/component */\nexport default CalendarWithEvents.extend({\n  name: 'v-calendar',\n\n  props: {\n    ...props.calendar,\n    ...props.weeks,\n    ...props.intervals,\n  },\n\n  data: () => ({\n    lastStart: null as VTimestamp | null,\n    lastEnd: null as VTimestamp | null,\n  }),\n\n  computed: {\n    parsedValue (): VTimestamp {\n      return (validateTimestamp(this.value)\n        ? parseTimestamp(this.value)\n        : (this.parsedStart || this.times.today)) as VTimestamp\n    },\n    renderProps (): VCalendarRenderProps {\n      const around = this.parsedValue\n      let component: any = null\n      let maxDays = this.maxDays\n      let start = around\n      let end = around\n      switch (this.type) {\n        case 'month':\n          component = VCalendarMonthly\n          start = getStartOfMonth(around)\n          end = getEndOfMonth(around)\n          break\n        case 'week':\n          component = VCalendarDaily\n          start = this.getStartOfWeek(around)\n          end = this.getEndOfWeek(around)\n          maxDays = 7\n          break\n        case 'day':\n          component = VCalendarDaily\n          maxDays = 1\n          break\n        case '4day':\n          component = VCalendarDaily\n          end = relativeDays(copyTimestamp(end), nextDay, 4)\n          updateFormatted(end)\n          maxDays = 4\n          break\n        case 'custom-weekly':\n          component = VCalendarWeekly\n          start = this.parsedStart || around\n          end = this.parsedEnd\n          break\n        case 'custom-daily':\n          component = VCalendarDaily\n          start = this.parsedStart || around\n          end = this.parsedEnd\n          break\n        default:\n          throw new Error(this.type + ' is not a valid Calendar type')\n      }\n\n      return { component, start, end, maxDays }\n    },\n  },\n\n  watch: {\n    renderProps: 'checkChange',\n  },\n\n  mounted () {\n    this.updateEventVisibility()\n  },\n\n  updated () {\n    this.updateEventVisibility()\n  },\n\n  methods: {\n    checkChange (): void {\n      const { start, end } = this.renderProps\n      if (start !== this.lastStart || end !== this.lastEnd) {\n        this.lastStart = start\n        this.lastEnd = end\n        this.$emit('change', { start, end })\n      }\n    },\n    move (amount = 1): void {\n      const moved = copyTimestamp(this.parsedValue)\n      const forward = amount > 0\n      const mover = forward ? nextDay : prevDay\n      const limit = forward ? DAYS_IN_MONTH_MAX : DAY_MIN\n      let times = forward ? amount : -amount\n\n      while (--times >= 0) {\n        switch (this.type) {\n          case 'month':\n            moved.day = limit\n            mover(moved)\n            break\n          case 'week':\n            relativeDays(moved, mover, DAYS_IN_WEEK)\n            break\n          case 'day':\n            const index = moved.weekday\n            const days = forward ? this.weekdaySkips[index] : this.weekdaySkipsReverse[index]\n            relativeDays(moved, mover, days)\n            break\n          case '4day':\n            relativeDays(moved, mover, 4)\n            break\n        }\n      }\n\n      updateWeekday(moved)\n      updateFormatted(moved)\n      updateRelative(moved, this.times.now)\n\n      this.$emit('input', moved.date)\n      this.$emit('moved', moved)\n    },\n    next (amount = 1): void {\n      this.move(amount)\n    },\n    prev (amount = 1): void {\n      this.move(-amount)\n    },\n    timeToY (time: VTime, clamp = true): number | false {\n      const c = this.$children[0] as any\n      if (c && c.timeToY) {\n        return c.timeToY(time, clamp)\n      } else {\n        return false\n      }\n    },\n    minutesToPixels (minutes: number): number {\n      const c = this.$children[0] as any\n      if (c && c.minutesToPixels) {\n        return c.minutesToPixels(minutes)\n      } else {\n        return -1\n      }\n    },\n    scrollToTime (time: VTime): boolean {\n      const c = this.$children[0] as any\n      if (c && c.scrollToTime) {\n        return c.scrollToTime(time)\n      } else {\n        return false\n      }\n    },\n  },\n\n  render (h): VNode {\n    const { start, end, maxDays, component } = this.renderProps\n\n    return h(component, {\n      staticClass: 'v-calendar',\n      class: {\n        'v-calendar-events': !this.noEvents,\n      },\n      props: {\n        ...this.$props,\n        start: start.date,\n        end: end.date,\n        maxDays,\n      },\n      directives: [{\n        modifiers: { quiet: true },\n        name: 'resize',\n        value: this.updateEventVisibility,\n      }],\n      on: {\n        ...this.$listeners,\n        'click:date': (day: VTimestamp) => {\n          if (this.$listeners['input']) {\n            this.$emit('input', day.date)\n          }\n          if (this.$listeners['click:date']) {\n            this.$emit('click:date', day)\n          }\n        },\n      },\n      scopedSlots: this.getScopedSlots(),\n    })\n  },\n})\n"],"sourceRoot":""}