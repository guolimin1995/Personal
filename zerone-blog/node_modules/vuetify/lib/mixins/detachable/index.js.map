{"version":3,"sources":["../../../src/mixins/detachable/index.ts"],"names":[],"mappings":"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","sourcesContent":["// Mixins\nimport Bootable from '../bootable'\n\n// Utilities\nimport { getObjectValueByPath } from '../../util/helpers'\nimport mixins, { ExtractVue } from '../../util/mixins'\nimport { consoleWarn } from '../../util/console'\n\n// Types\nimport Vue, { PropOptions } from 'vue'\nimport { VNode } from 'vue/types'\n\ninterface options extends Vue {\n  $el: HTMLElement\n  $refs: {\n    content: HTMLElement\n  }\n}\n\nfunction validateAttachTarget (val: any) {\n  const type = typeof val\n\n  if (type === 'boolean' || type === 'string') return true\n\n  return val.nodeType === Node.ELEMENT_NODE\n}\n\n/* @vue/component */\nexport default mixins<options &\n  /* eslint-disable indent */\n  ExtractVue<typeof Bootable>\n  /* eslint-enable indent */\n>(Bootable).extend({\n  name: 'detachable',\n\n  props: {\n    attach: {\n      default: false,\n      validator: validateAttachTarget,\n    } as PropOptions<boolean | string | Element>,\n    contentClass: {\n      type: String,\n      default: '',\n    },\n  },\n\n  data: () => ({\n    activatorNode: null as null | VNode | VNode[],\n    hasDetached: false,\n  }),\n\n  watch: {\n    attach () {\n      this.hasDetached = false\n      this.initDetach()\n    },\n    hasContent: 'initDetach',\n  },\n\n  beforeMount () {\n    this.$nextTick(() => {\n      if (this.activatorNode) {\n        const activator = Array.isArray(this.activatorNode) ? this.activatorNode : [this.activatorNode]\n\n        activator.forEach(node => {\n          if (!node.elm) return\n          if (!this.$el.parentNode) return\n\n          const target = this.$el === this.$el.parentNode.firstChild\n            ? this.$el\n            : this.$el.nextSibling\n\n          this.$el.parentNode.insertBefore(node.elm, target)\n        })\n      }\n    })\n  },\n\n  mounted () {\n    this.eager && this.initDetach()\n  },\n\n  deactivated () {\n    this.isActive = false\n  },\n\n  beforeDestroy () {\n    // IE11 Fix\n    try {\n      if (\n        this.$refs.content &&\n        this.$refs.content.parentNode\n      ) {\n        this.$refs.content.parentNode.removeChild(this.$refs.content)\n      }\n\n      if (this.activatorNode) {\n        const activator = Array.isArray(this.activatorNode) ? this.activatorNode : [this.activatorNode]\n        activator.forEach(node => {\n          node.elm &&\n            node.elm.parentNode &&\n            node.elm.parentNode.removeChild(node.elm)\n        })\n      }\n    } catch (e) { console.log(e) }\n  },\n\n  methods: {\n    getScopeIdAttrs () {\n      const scopeId = getObjectValueByPath(this.$vnode, 'context.$options._scopeId')\n\n      return scopeId && {\n        [scopeId]: '',\n      }\n    },\n    initDetach () {\n      if (this._isDestroyed ||\n        !this.$refs.content ||\n        this.hasDetached ||\n        // Leave menu in place if attached\n        // and dev has not changed target\n        this.attach === '' || // If used as a boolean prop (<v-menu attach>)\n        this.attach === true || // If bound to a boolean (<v-menu :attach=\"true\">)\n        this.attach === 'attach' // If bound as boolean prop in pug (v-menu(attach))\n      ) return\n\n      let target\n      if (this.attach === false) {\n        // Default, detach to app\n        target = document.querySelector('[data-app]')\n      } else if (typeof this.attach === 'string') {\n        // CSS selector\n        target = document.querySelector(this.attach)\n      } else {\n        // DOM Element\n        target = this.attach\n      }\n\n      if (!target) {\n        consoleWarn(`Unable to locate target ${this.attach || '[data-app]'}`, this)\n        return\n      }\n\n      target.insertBefore(\n        this.$refs.content,\n        target.firstChild\n      )\n\n      this.hasDetached = true\n    },\n  },\n})\n"],"sourceRoot":""}